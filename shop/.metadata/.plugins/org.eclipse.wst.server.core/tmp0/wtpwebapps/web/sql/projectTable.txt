/* CART */
CREATE TABLE CART (
	C_NO NUMBER(5) NOT NULL, /* 장바구니번호 */
	M_ID VARCHAR2(20) NOT NULL /* 회원ID */
);

COMMENT ON TABLE CART IS 'CART';

COMMENT ON COLUMN CART.C_NO IS '장바구니번호';

COMMENT ON COLUMN CART.M_ID IS '회원ID';

CREATE UNIQUE INDEX CART_C_NO_PK
	ON CART (
		C_NO ASC
	);

ALTER TABLE CART
	ADD
		CONSTRAINT CART_C_NO_PK
		PRIMARY KEY (
			C_NO
		);

/* CART_DETAIL */
CREATE TABLE CART_DETAIL (
	C_NO NUMBER(5) NOT NULL, /* 장바구니번호 */
	M_ID VARCHAR2(20) NOT NULL, /* 회원ID */
	P_NO NUMBER(5) NOT NULL, /* 상품번호 */
	P_NAME VARCHAR2(50) NOT NULL, /* 상품이름 */
	B_QTT NUMBER(3) NOT NULL /* 구매수량 */
);

COMMENT ON TABLE CART_DETAIL IS 'CART_DETAIL';

COMMENT ON COLUMN CART_DETAIL.C_NO IS '장바구니번호';

COMMENT ON COLUMN CART_DETAIL.M_ID IS '회원ID';

COMMENT ON COLUMN CART_DETAIL.P_NO IS '상품번호';

COMMENT ON COLUMN CART_DETAIL.P_NAME IS '상품이름';

COMMENT ON COLUMN CART_DETAIL.B_QTT IS '구매수량';

CREATE UNIQUE INDEX PK_CART_DETAIL
	ON CART_DETAIL (
		C_NO ASC
	);

ALTER TABLE CART_DETAIL
	ADD
		CONSTRAINT PK_CART_DETAIL
		PRIMARY KEY (
			C_NO
		);

/* MEMBER */
CREATE TABLE MEMBER (
	M_NO NUMBER(5) NOT NULL, /* 회원번호 */
	M_ID VARCHAR2(20) NOT NULL, /* 회원ID */
	M_NAME VARCHAR2(10) NOT NULL, /* 회원이름 */
	M_PW VARCHAR2(20) NOT NULL, /* 비밀번호 */
	GENDER VARCHAR2(5), /* 성별 */
	BIRTH DATE NOT NULL, /* 생년월일 */
	M_ADDR VARCHAR2(200) NOT NULL, /* 회원주소 */
	HP VARCHAR2(14) NOT NULL, /* 휴대폰번호 */
	GRADE VARCHAR2(10) DEFAULT 'WHITE', /* 회원등급 */
	POINT NUMBER(8) DEFAULT 1004, /* 포인트 */
	PRICE_SUM NUMBER(8) NOT NULL, /* 구입누적금액 */
	JOINDATE DATE NOT NULL /* 가입일 */
);

COMMENT ON TABLE MEMBER IS 'MEMBER';

COMMENT ON COLUMN MEMBER.M_NO IS '회원번호';

COMMENT ON COLUMN MEMBER.M_ID IS '회원ID';

COMMENT ON COLUMN MEMBER.M_NAME IS '회원이름';

COMMENT ON COLUMN MEMBER.M_PW IS '비밀번호';

COMMENT ON COLUMN MEMBER.GENDER IS '성별';

COMMENT ON COLUMN MEMBER.BIRTH IS '생년월일';

COMMENT ON COLUMN MEMBER.M_ADDR IS '회원주소';

COMMENT ON COLUMN MEMBER.HP IS '휴대폰번호';

COMMENT ON COLUMN MEMBER.GRADE IS '회원등급';

COMMENT ON COLUMN MEMBER.POINT IS '포인트';

COMMENT ON COLUMN MEMBER.PRICE_SUM IS '구입누적금액';

COMMENT ON COLUMN MEMBER.JOINDATE IS '가입일';

CREATE UNIQUE INDEX MEMBER_M_NO_PK
	ON MEMBER (
		M_NO ASC
	);

CREATE UNIQUE INDEX MEMBER_ID_UQ
	ON MEMBER (
		M_ID ASC
	);

ALTER TABLE MEMBER
	ADD
		CONSTRAINT MEMBER_M_NO_PK
		PRIMARY KEY (
			M_NO
		);

ALTER TABLE MEMBER
	ADD
		CONSTRAINT MEMBER_ID_UQ
		UNIQUE (
			M_ID
		);

ALTER TABLE MEMBER
	ADD
		CONSTRAINT MEMBER_GENDER_CK
		CHECK (GENDER IN('남성','여성'));

/* NOTICE */
CREATE TABLE NOTICE (
	N_NO NUMBER(5) NOT NULL, /* 공지번호 */
	N_TITLE VARCHAR2(50) NOT NULL, /* 공지제목 */
	M_ID VARCHAR2(20) NOT NULL, /* 회원ID */
	N_CONTENTS CLOB, /* 공지내용 */
	N_REGDATE DATE NOT NULL /* 공지일자 */
);

COMMENT ON TABLE NOTICE IS 'NOTICE';

COMMENT ON COLUMN NOTICE.N_NO IS '공지번호';

COMMENT ON COLUMN NOTICE.N_TITLE IS '공지제목';

COMMENT ON COLUMN NOTICE.M_ID IS '회원ID';

COMMENT ON COLUMN NOTICE.N_CONTENTS IS '공지내용';

COMMENT ON COLUMN NOTICE.N_REGDATE IS '공지일자';

CREATE UNIQUE INDEX NOTICE_N_NO_PK
	ON NOTICE (
		N_NO ASC
	);

ALTER TABLE NOTICE
	ADD
		CONSTRAINT NOTICE_N_NO_PK
		PRIMARY KEY (
			N_NO
		);

/* ORDERLIST */
CREATE TABLE ORDERLIST (
	O_NO NUMBER(5) NOT NULL, /* 주문번호 */
	M_ID VARCHAR2(20) NOT NULL, /* 회원ID */
	O_DATE DATE NOT NULL, /* 주문일자 */
	O_STATUS VARCHAR2(30) DEFAULT '상품준비중' NOT NULL, /* 주문상태 */
	D_NAME VARCHAR2(10) NOT NULL, /* 수취인명 */
	D_TEL VARCHAR2(14) NOT NULL, /* 수취인번호 */
	D_ZIPCODE VARCHAR2(7) NOT NULL, /* 수취인 우편번호 */
	D_ADDR VARCHAR2(150) NOT NULL, /* 수취인 주소 */
	D_MSG VARCHAR2(50) /* 요청사항 */
);

COMMENT ON TABLE ORDERLIST IS 'ORDERLIST';

COMMENT ON COLUMN ORDERLIST.O_NO IS '주문번호';

COMMENT ON COLUMN ORDERLIST.M_ID IS '회원ID';

COMMENT ON COLUMN ORDERLIST.O_DATE IS '주문일자';

COMMENT ON COLUMN ORDERLIST.O_STATUS IS '주문상태';

COMMENT ON COLUMN ORDERLIST.D_NAME IS '수취인명';

COMMENT ON COLUMN ORDERLIST.D_TEL IS '수취인번호';

COMMENT ON COLUMN ORDERLIST.D_ZIPCODE IS '수취인 우편번호';

COMMENT ON COLUMN ORDERLIST.D_ADDR IS '수취인 주소';

COMMENT ON COLUMN ORDERLIST.D_MSG IS '요청사항';

CREATE UNIQUE INDEX ORDERLIST_O_NO_PK
	ON ORDERLIST (
		O_NO ASC
	);

ALTER TABLE ORDERLIST
	ADD
		CONSTRAINT ORDERLIST_O_NO_PK
		PRIMARY KEY (
			O_NO
		);

/* ORDER_DETAIL */
CREATE TABLE ORDER_DETAIL (
	O_NO NUMBER(5) NOT NULL, /* 주문번호 */
	M_ID VARCHAR2(20) NOT NULL, /* 회원ID */
	P_NO NUMBER(5) NOT NULL, /* 상품번호 */
	P_NAME VARCHAR2(50) NOT NULL, /* 상품이름 */
	O_QTT NUMBER(3) NOT NULL /* 주문수량 */
);

COMMENT ON TABLE ORDER_DETAIL IS 'ORDER_DETAIL';

COMMENT ON COLUMN ORDER_DETAIL.O_NO IS '주문번호';

COMMENT ON COLUMN ORDER_DETAIL.M_ID IS '회원ID';

COMMENT ON COLUMN ORDER_DETAIL.P_NO IS '상품번호';

COMMENT ON COLUMN ORDER_DETAIL.P_NAME IS '상품이름';

COMMENT ON COLUMN ORDER_DETAIL.O_QTT IS '주문수량';

CREATE UNIQUE INDEX ORDER_DETAIL_O_NO_PK
	ON ORDER_DETAIL (
		O_NO ASC
	);

ALTER TABLE ORDER_DETAIL
	ADD
		CONSTRAINT ORDER_DETAIL_O_NO_PK
		PRIMARY KEY (
			O_NO
		);

/* PRODUCT */
CREATE TABLE PRODUCT (
	P_NO NUMBER(5) NOT NULL, /* 상품번호 */
	P_NAME VARCHAR2(50) NOT NULL, /* 상품이름 */
	CATEGORY VARCHAR2(30) NOT NULL, /* 상품분류 */
	PRICE NUMBER(8) NOT NULL, /* 상품가격 */
	INFO CLOB NOT NULL, /* 상품설명 */
	HIT NUMBER(3) NOT NULL, /* 판매량 */
	P_FILENAME VARCHAR2(100) NOT NULL, /* 상품이미지 */
	REGDATE DATE NOT NULL /* 출시일 */
);

COMMENT ON TABLE PRODUCT IS 'PRODUCT';

COMMENT ON COLUMN PRODUCT.P_NO IS '상품번호';

COMMENT ON COLUMN PRODUCT.P_NAME IS '상품이름';

COMMENT ON COLUMN PRODUCT.CATEGORY IS '상품분류';

COMMENT ON COLUMN PRODUCT.PRICE IS '상품가격';

COMMENT ON COLUMN PRODUCT.INFO IS '상품설명';

COMMENT ON COLUMN PRODUCT.HIT IS '판매량';

COMMENT ON COLUMN PRODUCT.P_FILENAME IS '상품이미지';

COMMENT ON COLUMN PRODUCT.REGDATE IS '출시일';

CREATE UNIQUE INDEX PRODUCT_P_NO_PK
	ON PRODUCT (
		P_NO ASC
	);

CREATE UNIQUE INDEX PRODUCT_P_NAME_UQ
	ON PRODUCT (
		P_NAME ASC
	);

ALTER TABLE PRODUCT
	ADD
		CONSTRAINT PRODUCT_P_NO_PK
		PRIMARY KEY (
			P_NO
		);

ALTER TABLE PRODUCT
	ADD
		CONSTRAINT PRODUCT_P_NAME_UQ
		UNIQUE (
			P_NAME
		);

/* PRODUCT_DETAIL */
CREATE TABLE PRODUCT_DETAIL (
	P_NO NUMBER(5) NOT NULL, /* 상품번호 */
	P_NAME VARCHAR2(50) NOT NULL, /* 상품이름 */
	P_SIZE NUMBER(3) NOT NULL, /* 사이즈 */
	QTT NUMBER(3) NOT NULL /* 입고수량 */
);

COMMENT ON TABLE PRODUCT_DETAIL IS 'PRODUCT_DETAIL';

COMMENT ON COLUMN PRODUCT_DETAIL.P_NO IS '상품번호';

COMMENT ON COLUMN PRODUCT_DETAIL.P_NAME IS '상품이름';

COMMENT ON COLUMN PRODUCT_DETAIL.P_SIZE IS '사이즈';

COMMENT ON COLUMN PRODUCT_DETAIL.QTT IS '입고수량';

/* QNA */
CREATE TABLE QNA (
	Q_NO NUMBER(5) NOT NULL, /* 문의번호 */
	Q_TITLE VARCHAR2(50) NOT NULL, /* 문의제목 */
	M_ID VARCHAR2(20) NOT NULL, /* 회원ID */
	Q_CONTENTS CLOB, /* 문의내용 */
	Q_REGDATE DATE NOT NULL, /* 문의일자 */
	Q_COMMENTS VARCHAR2(500) DEFAULT '고객님의 문의사항에 성심껏 대답해드리겠습니다.'
 /* 문의답변 */
);

COMMENT ON TABLE QNA IS 'QNA';

COMMENT ON COLUMN QNA.Q_NO IS '문의번호';

COMMENT ON COLUMN QNA.Q_TITLE IS '문의제목';

COMMENT ON COLUMN QNA.M_ID IS '회원ID';

COMMENT ON COLUMN QNA.Q_CONTENTS IS '문의내용';

COMMENT ON COLUMN QNA.Q_REGDATE IS '문의일자';

COMMENT ON COLUMN QNA.Q_COMMENTS IS '문의답변';

CREATE UNIQUE INDEX QNA_Q_NO_PK
	ON QNA (
		Q_NO ASC
	);

ALTER TABLE QNA
	ADD
		CONSTRAINT QNA_Q_NO_PK
		PRIMARY KEY (
			Q_NO
		);

/* REVIEW */
CREATE TABLE REVIEW (
	R_NO NUMBER(5) NOT NULL, /* 리뷰번호 */
	P_NO NUMBER(5) NOT NULL, /* 상품번호 */
	R_TITLE VARCHAR2(50) NOT NULL, /* 리뷰제목 */
	M_ID VARCHAR2(20) NOT NULL, /* 회원ID */
	R_CONTENTS CLOB, /* 리뷰내용 */
	R_REGDATE DATE NOT NULL, /* 리뷰일자 */
	R_COMMENTS VARCHAR2(500) DEFAULT '구매해주셔서 감사합니다'
 /* 리뷰답글 */
);

COMMENT ON TABLE REVIEW IS 'REVIEW';

COMMENT ON COLUMN REVIEW.R_NO IS '리뷰번호';

COMMENT ON COLUMN REVIEW.P_NO IS '상품번호';

COMMENT ON COLUMN REVIEW.R_TITLE IS '리뷰제목';

COMMENT ON COLUMN REVIEW.M_ID IS '회원ID';

COMMENT ON COLUMN REVIEW.R_CONTENTS IS '리뷰내용';

COMMENT ON COLUMN REVIEW.R_REGDATE IS '리뷰일자';

COMMENT ON COLUMN REVIEW.R_COMMENTS IS '리뷰답글';

CREATE UNIQUE INDEX REVIEW_R_NO_PK
	ON REVIEW (
		R_NO ASC
	);

ALTER TABLE REVIEW
	ADD
		CONSTRAINT REVIEW_R_NO_PK
		PRIMARY KEY (
			R_NO
		);

/* ZIPCODE */
CREATE TABLE ZIPCODE (
	ZIPCODE VARCHAR2(7) NOT NULL, /* 우편번호 */
	SIDO VARCHAR2(4) NOT NULL, /* 시,도 */
	GUGUN VARCHAR2(15) NOT NULL, /* 구,군 */
	DONG VARCHAR2(52) NOT NULL, /* 동 */
	BUNJI VARCHAR2(17), /* 번지 */
	SEQ NUMBER(5) NOT NULL /* 주소번호 */
);

COMMENT ON TABLE ZIPCODE IS 'ZIPCODE';

COMMENT ON COLUMN ZIPCODE.ZIPCODE IS '우편번호';

COMMENT ON COLUMN ZIPCODE.SIDO IS '시,도';

COMMENT ON COLUMN ZIPCODE.GUGUN IS '구,군';

COMMENT ON COLUMN ZIPCODE.DONG IS '동';

COMMENT ON COLUMN ZIPCODE.BUNJI IS '번지';

COMMENT ON COLUMN ZIPCODE.SEQ IS '주소번호';

ALTER TABLE CART
	ADD
		CONSTRAINT CART_M_ID_FK
		FOREIGN KEY (
			M_ID
		)
		REFERENCES MEMBER (
			M_ID
		)
		ON DELETE CASCADE;

ALTER TABLE CART_DETAIL
	ADD
		CONSTRAINT CART_DETAIL_P_NAME_FK
		FOREIGN KEY (
			P_NAME
		)
		REFERENCES PRODUCT (
			P_NAME
		)
		ON DELETE CASCADE;

ALTER TABLE CART_DETAIL
	ADD
		CONSTRAINT CART_DETAIL_P_NO_FK
		FOREIGN KEY (
			P_NO
		)
		REFERENCES PRODUCT (
			P_NO
		)
		ON DELETE CASCADE;

ALTER TABLE CART_DETAIL
	ADD
		CONSTRAINT CART_DETAIL_M_ID_FK
		FOREIGN KEY (
			M_ID
		)
		REFERENCES MEMBER (
			M_ID
		)
		ON DELETE CASCADE;

ALTER TABLE CART_DETAIL
	ADD
		CONSTRAINT FK_CART_TO_CART_DETAIL
		FOREIGN KEY (
			C_NO
		)
		REFERENCES CART (
			C_NO
		);

ALTER TABLE NOTICE
	ADD
		CONSTRAINT NOTICE_M_ID_FK
		FOREIGN KEY (
			M_ID
		)
		REFERENCES MEMBER (
			M_ID
		)
		ON DELETE CASCADE;

ALTER TABLE ORDERLIST
	ADD
		CONSTRAINT ORDERLIST_M_ID_FK
		FOREIGN KEY (
			M_ID
		)
		REFERENCES MEMBER (
			M_ID
		)
		ON DELETE CASCADE;

ALTER TABLE ORDER_DETAIL
	ADD
		CONSTRAINT ORDER_DETAIL_P_NAME_FK
		FOREIGN KEY (
			P_NAME
		)
		REFERENCES PRODUCT (
			P_NAME
		)
		ON DELETE CASCADE;

ALTER TABLE ORDER_DETAIL
	ADD
		CONSTRAINT ORDER_DETAIL_P_NO_FK
		FOREIGN KEY (
			P_NO
		)
		REFERENCES PRODUCT (
			P_NO
		)
		ON DELETE CASCADE;

ALTER TABLE ORDER_DETAIL
	ADD
		CONSTRAINT ORDER_DETAIL_M_ID_FK
		FOREIGN KEY (
			M_ID
		)
		REFERENCES MEMBER (
			M_ID
		)
		ON DELETE CASCADE;

ALTER TABLE ORDER_DETAIL
	ADD
		CONSTRAINT ORDER_DETAIL_O_NO_FK
		FOREIGN KEY (
			O_NO
		)
		REFERENCES ORDERLIST (
			O_NO
		);

ALTER TABLE PRODUCT_DETAIL
	ADD
		CONSTRAINT PRODUCT_DETAIL_P_NAME_FK
		FOREIGN KEY (
			P_NAME
		)
		REFERENCES PRODUCT (
			P_NAME
		)
		ON DELETE CASCADE;

ALTER TABLE PRODUCT_DETAIL
	ADD
		CONSTRAINT PRODUCT_DETAIL_P_NO_FK
		FOREIGN KEY (
			P_NO
		)
		REFERENCES PRODUCT (
			P_NO
		)
		ON DELETE CASCADE;

ALTER TABLE QNA
	ADD
		CONSTRAINT QNA_M_ID_FK
		FOREIGN KEY (
			M_ID
		)
		REFERENCES MEMBER (
			M_ID
		)
		ON DELETE CASCADE;

ALTER TABLE REVIEW
	ADD
		CONSTRAINT REVIEW_M_ID_FK
		FOREIGN KEY (
			M_ID
		)
		REFERENCES MEMBER (
			M_ID
		)
		ON DELETE CASCADE;

ALTER TABLE REVIEW
	ADD
		CONSTRAINT REVIEW_P_NO_FK
		FOREIGN KEY (
			P_NO
		)
		REFERENCES PRODUCT (
			P_NO
		)
		ON DELETE CASCADE;

